rules:
  - id: docker-avoid-latest
    languages: [dockerfile]
    message: "Avoid 'latest' tag; pin a digest or version."
    severity: WARNING
    pattern: FROM $IMAGE:latest

  - id: k8s-no-privileged
    languages: [yaml]
    message: "Kubernetes container should not run privileged."
    severity: ERROR
    pattern-either:
      - pattern: "securityContext: { privileged: true }"
      - pattern: |
          securityContext:
            privileged: true
